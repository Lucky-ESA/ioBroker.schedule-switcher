{
  "version": 3,
  "sources": ["../../src/schedules/Schedule.ts"],
  "sourcesContent": ["import { Destroyable } from \"../Destroyable\";\nimport { UniversalTriggerScheduler } from \"../scheduler/UniversalTriggerScheduler\";\nimport { LoggingService } from \"../services/LoggingService\";\nimport { Trigger } from \"../triggers/Trigger\";\n\nexport abstract class Schedule implements Destroyable {\n    private enabled = false;\n    private name = \"New Schedule\";\n    private triggers: Trigger[] = [];\n    private readonly triggerScheduler: UniversalTriggerScheduler;\n    private logger: LoggingService;\n\n    protected constructor(triggerScheduler: UniversalTriggerScheduler, logger: LoggingService) {\n        if (triggerScheduler == null) {\n            throw new Error(`triggerScheduler may not be null or undefined`);\n        }\n        this.triggerScheduler = triggerScheduler;\n        this.logger = logger;\n    }\n\n    public setEnabled(enabled: boolean): void {\n        if (enabled !== this.enabled) {\n            if (enabled) {\n                this.getTriggers().forEach((t) => this.triggerScheduler.register(t));\n            } else {\n                this.triggerScheduler.destroy();\n            }\n            this.enabled = enabled;\n        }\n    }\n\n    public setName(name: string): void {\n        if (name == null) {\n            this.logger.logWarn(`name may not be null or undefined`);\n            name = \"Unknown\";\n        }\n        this.name = name;\n    }\n\n    public isEnabled(): boolean {\n        return this.enabled;\n    }\n\n    public getName(): string {\n        return this.name;\n    }\n\n    public getTriggers(): Trigger[] {\n        return this.triggers;\n    }\n\n    public addTrigger(trigger: Trigger): void {\n        if (this.findTriggerById(trigger.getId())) {\n            this.logger.logWarn(`Cannot add trigger, trigger id ${trigger.getId()} exists already`);\n        } else {\n            this.triggers.push(trigger);\n            if (this.isEnabled()) {\n                this.triggerScheduler.register(trigger);\n            }\n        }\n    }\n\n    public updateTrigger(trigger: Trigger): void {\n        const index = this.getTriggers().findIndex((t) => t.getId() === trigger.getId());\n        if (index == -1) {\n            this.logger.logWarn(`Cannot update trigger, trigger id ${trigger.getId()} not found`);\n        } else {\n            if (this.isEnabled()) {\n                this.triggerScheduler.unregister(this.getTriggers()[index]);\n                this.triggerScheduler.register(trigger);\n            }\n            this.triggers[index] = trigger;\n        }\n    }\n\n    public removeTrigger(triggerId: string): void {\n        const trigger = this.triggers.find((t) => t.getId() === triggerId);\n        if (trigger) {\n            this.removeTriggerAndUnregister(trigger);\n        } else {\n            this.logger.logInfo(`Cannot delete trigger, trigger id ${triggerId} not found`);\n        }\n    }\n\n    public destroy(): void {\n        if (this.isEnabled()) {\n            this.triggerScheduler.destroy();\n        }\n        this.triggers = [];\n    }\n\n    private removeTriggerAndUnregister(trigger: Trigger): void {\n        if (this.isEnabled()) {\n            this.triggerScheduler.unregister(trigger);\n        }\n        this.triggers = this.triggers.filter((t) => t.getId() !== trigger.getId());\n    }\n\n    private findTriggerById(id: string): Trigger | undefined {\n        return this.getTriggers().find((t) => t.getId() === id);\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAKO,MAAe,SAAgC;AAAA,EAC1C,UAAU;AAAA,EACV,OAAO;AAAA,EACP,WAAsB,CAAC;AAAA,EACd;AAAA,EACT;AAAA,EAEE,YAAY,kBAA6C,QAAwB;AACvF,QAAI,oBAAoB,MAAM;AAC1B,YAAM,IAAI,MAAM,+CAA+C;AAAA,IACnE;AACA,SAAK,mBAAmB;AACxB,SAAK,SAAS;AAAA,EAClB;AAAA,EAEO,WAAW,SAAwB;AACtC,QAAI,YAAY,KAAK,SAAS;AAC1B,UAAI,SAAS;AACT,aAAK,YAAY,EAAE,QAAQ,CAAC,MAAM,KAAK,iBAAiB,SAAS,CAAC,CAAC;AAAA,MACvE,OAAO;AACH,aAAK,iBAAiB,QAAQ;AAAA,MAClC;AACA,WAAK,UAAU;AAAA,IACnB;AAAA,EACJ;AAAA,EAEO,QAAQ,MAAoB;AAC/B,QAAI,QAAQ,MAAM;AACd,WAAK,OAAO,QAAQ,mCAAmC;AACvD,aAAO;AAAA,IACX;AACA,SAAK,OAAO;AAAA,EAChB;AAAA,EAEO,YAAqB;AACxB,WAAO,KAAK;AAAA,EAChB;AAAA,EAEO,UAAkB;AACrB,WAAO,KAAK;AAAA,EAChB;AAAA,EAEO,cAAyB;AAC5B,WAAO,KAAK;AAAA,EAChB;AAAA,EAEO,WAAW,SAAwB;AACtC,QAAI,KAAK,gBAAgB,QAAQ,MAAM,CAAC,GAAG;AACvC,WAAK,OAAO,QAAQ,kCAAkC,QAAQ,MAAM,CAAC,iBAAiB;AAAA,IAC1F,OAAO;AACH,WAAK,SAAS,KAAK,OAAO;AAC1B,UAAI,KAAK,UAAU,GAAG;AAClB,aAAK,iBAAiB,SAAS,OAAO;AAAA,MAC1C;AAAA,IACJ;AAAA,EACJ;AAAA,EAEO,cAAc,SAAwB;AACzC,UAAM,QAAQ,KAAK,YAAY,EAAE,UAAU,CAAC,MAAM,EAAE,MAAM,MAAM,QAAQ,MAAM,CAAC;AAC/E,QAAI,SAAS,IAAI;AACb,WAAK,OAAO,QAAQ,qCAAqC,QAAQ,MAAM,CAAC,YAAY;AAAA,IACxF,OAAO;AACH,UAAI,KAAK,UAAU,GAAG;AAClB,aAAK,iBAAiB,WAAW,KAAK,YAAY,EAAE,KAAK,CAAC;AAC1D,aAAK,iBAAiB,SAAS,OAAO;AAAA,MAC1C;AACA,WAAK,SAAS,KAAK,IAAI;AAAA,IAC3B;AAAA,EACJ;AAAA,EAEO,cAAc,WAAyB;AAC1C,UAAM,UAAU,KAAK,SAAS,KAAK,CAAC,MAAM,EAAE,MAAM,MAAM,SAAS;AACjE,QAAI,SAAS;AACT,WAAK,2BAA2B,OAAO;AAAA,IAC3C,OAAO;AACH,WAAK,OAAO,QAAQ,qCAAqC,SAAS,YAAY;AAAA,IAClF;AAAA,EACJ;AAAA,EAEO,UAAgB;AACnB,QAAI,KAAK,UAAU,GAAG;AAClB,WAAK,iBAAiB,QAAQ;AAAA,IAClC;AACA,SAAK,WAAW,CAAC;AAAA,EACrB;AAAA,EAEQ,2BAA2B,SAAwB;AACvD,QAAI,KAAK,UAAU,GAAG;AAClB,WAAK,iBAAiB,WAAW,OAAO;AAAA,IAC5C;AACA,SAAK,WAAW,KAAK,SAAS,OAAO,CAAC,MAAM,EAAE,MAAM,MAAM,QAAQ,MAAM,CAAC;AAAA,EAC7E;AAAA,EAEQ,gBAAgB,IAAiC;AACrD,WAAO,KAAK,YAAY,EAAE,KAAK,CAAC,MAAM,EAAE,MAAM,MAAM,EAAE;AAAA,EAC1D;AACJ;",
  "names": []
}
